# LINE Beacon 管理系統功能說明

## 📋 目前開發狀況

### ✅ 已完成功能

#### 1. 統計儀表板
- **總設備數**：顯示已註冊的 Beacon 設備總數
- **今日觸發次數**：顯示今天所有 Beacon 被觸發的總次數
- **已加入好友推送**：顯示今天推送給已加入好友的用戶數量
- **未加入好友推送**：顯示今天推送給未加入好友的用戶數量
- **自動刷新**：每 30 秒自動更新統計數據

#### 2. 設備管理 (📡 設備管理 Tab)
- 新增 Beacon 設備
  - 設備名稱（必填）
  - HWID - Hardware ID（必填，10位16進制）
  - Vendor Key（選填，8位16進制）
  - Lot Key（選填，16位16進制）
  - 位置描述
  - 設備說明
  - 啟用/停用狀態
- 設備列表顯示
  - 卡片式呈現
  - 顯示所有設備資訊
  - 狀態標籤（啟用中/已停用）

#### 3. 觸發動作管理 (⚡ 觸發動作 Tab)
- 新增觸發動作
  - 動作名稱（必填）
  - 選擇設備（下拉選單）
  - 觸發類型：
    - 🚪 進入範圍 (Enter)
    - 👋 離開範圍 (Leave)
    - ⏱️ 停留範圍 (Stay)
  - 選擇推送訊息模板（下拉選單）
  - 動作說明
  - 啟用/停用狀態
- 觸發動作列表顯示
  - 顯示關聯的設備名稱
  - 顯示觸發類型
  - 顯示推送訊息模板名稱
  - 狀態標籤

#### 4. 推送訊息管理 (💬 推送訊息 Tab)
- 新增推送訊息模板
  - 模板名稱（必填）
  - 訊息類型：
    - 📝 純文字訊息
    - 🎴 Flex Message (卡片)
    - 🖼️ 圖片訊息
  - 訊息內容（必填）
    - 純文字：直接輸入文字
    - Flex Message：輸入 JSON 格式
  - 目標對象：
    - 👥 所有用戶
    - 👫 已加入好友
    - 👤 未加入好友
  - 模板說明
  - 啟用/停用狀態
- 推送訊息列表顯示
  - 顯示訊息類型
  - 顯示目標對象
  - 預覽訊息內容（前200字）
  - 狀態標籤

#### 5. 資料庫結構
- `beacon_devices`：設備註冊表
- `beacon_events`：觸發事件記錄表（含 is_friend 欄位）
- `beacon_actions`：觸發動作設定表（已更新結構）
- `beacon_messages`：推送訊息模板表（新增）
- `beacon_statistics`：統計表

## 🎯 LINE Simple Beacon 可達成的服務場景

### 1. 實體店面歡迎服務
**場景**：顧客進入店面時
- **觸發**：進入範圍 (Enter)
- **推送**：歡迎訊息 + 今日優惠
- **區分**：
  - 已加入好友：「歡迎回來！這是您的專屬優惠」
  - 未加入好友：「歡迎光臨！加入好友享更多優惠」

### 2. 離店感謝與評價邀請
**場景**：顧客離開店面時
- **觸發**：離開範圍 (Leave)
- **推送**：感謝訊息 + 評價邀請
- **內容**：「感謝光臨！歡迎給我們評價」

### 3. 展覽/活動簽到
**場景**：參加者進入展區
- **觸發**：進入範圍 (Enter)
- **推送**：活動資訊 + 簽到確認
- **統計**：記錄參加人數（已加入/未加入好友）

### 4. 產品展示區互動
**場景**：顧客靠近特定產品展示區
- **觸發**：進入範圍 (Enter)
- **推送**：產品介紹 + 優惠券
- **內容**：Flex Message 卡片式產品資訊

### 5. VIP 專區服務
**場景**：VIP 會員進入專區
- **觸發**：進入範圍 (Enter)
- **推送**：專屬服務通知
- **條件**：僅推送給已加入好友

### 6. 停車場服務
**場景**：顧客進入/離開停車場
- **進入觸發**：停車資訊 + 優惠時段
- **離開觸發**：繳費提醒 + 下次優惠

## 📊 統計功能說明

### 即時統計指標
1. **總設備數**：了解部署規模
2. **今日觸發次數**：了解人流量
3. **已加入好友推送**：了解會員互動
4. **未加入好友推送**：了解潛在客戶

### 數據應用
- **轉換率分析**：未加入 → 已加入好友的轉換
- **人流分析**：不同時段的觸發次數
- **設備效能**：各設備的觸發頻率
- **訊息效果**：不同訊息模板的推送次數

## 🔧 使用流程

### 步驟 1：新增設備
1. 進入「📡 設備管理」Tab
2. 點擊「➕ 新增設備」
3. 填寫設備資訊（HWID 必填）
4. 儲存

### 步驟 2：建立推送訊息
1. 進入「💬 推送訊息」Tab
2. 點擊「➕ 新增模板」
3. 設定訊息內容和目標對象
4. 儲存

### 步驟 3：設定觸發動作
1. 進入「⚡ 觸發動作」Tab
2. 點擊「➕ 新增動作」
3. 選擇設備、觸發類型、推送訊息
4. 儲存

### 步驟 4：監控統計
1. 查看儀表板統計數據
2. 每 30 秒自動刷新
3. 分析已加入/未加入好友的推送效果

## 🚀 下一步開發建議

### 優先功能
1. **編輯/刪除功能**：設備、動作、訊息的編輯和刪除
2. **詳細統計圖表**：時間軸圖表、設備比較
3. **訊息預覽**：Flex Message 即時預覽
4. **批次操作**：批次啟用/停用

### 進階功能
1. **A/B 測試**：不同訊息效果比較
2. **排程推送**：特定時間推送
3. **條件觸發**：根據用戶屬性推送
4. **匯出報表**：CSV/Excel 格式

## 📝 注意事項

1. **HWID 格式**：必須是 10 位 16 進制字元
2. **Flex Message**：需要符合 LINE Flex Message 規範
3. **推送限制**：注意 LINE Messaging API 的推送限制
4. **隱私權**：遵守個資法，妥善保管用戶資料

## 🔗 相關連結

- [LINE Simple Beacon 官方文件](https://developers.line.biz/en/docs/messaging-api/using-beacons/)
- [Flex Message Simulator](https://developers.line.biz/flex-simulator/)
- 管理後台：`/admin/beacon-manager.html`

